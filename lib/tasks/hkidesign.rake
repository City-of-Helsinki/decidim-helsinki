# frozen_string_literal: true

namespace :hkidesign do
  # Takes in the path to the cloned HDS repository from:
  # https://github.com/City-of-Helsinki/helsinki-design-system
  #
  # Note that this script assumes the icons to be located within the following
  # subfolder of that path: packages/core/src/svg/ui
  desc "Create the icons pack from the Helsinki design assets."
  task :create_icons, [:hds_path] do |_t, args|
    icons_dir = "#{args[:hds_path]}/packages/core/src/svg"
    unless File.directory?(icons_dir)
      puts "The following folder does not exist: #{icons_dir}"
      next
    end

    target_path = File.expand_path("../../app/packs/images/helsinki/helsinki-icons.svg", __dir__)
    if File.exist?(target_path)
      puts "The target icons file exists. Do you want to override it? (y/n)"
      confirm = $stdin.gets.chomp.downcase
      if confirm != "y"
        puts "Icons conversion aborted."
        next
      end
    end

    # To be used as a fallback for the icons that do not have an equivalent
    # defined. Those icons have equivalent marked as `nil` in the mapping.
    original_set_path = "#{Gem.loaded_specs["decidim-core"].full_gem_path}/app/packs/images/decidim/icons.svg"
    original_set = Nokogiri::XML.parse(File.read(original_set_path))
    original_icons = original_set.css("symbol").collect.to_h do |node|
      [node["id"].sub(/^icon-/, "").to_sym, { content: node.inner_html, attributes: { "viewBox" => node["viewBox"] } }]
    end

    # Maps the original Decidim icon names to HDS icon equivalents.
    # Decidim icons set (up to 0.27): https://github.com/iconic/open-iconic/tree/master/svg
    # HDS icons: https://hds.hel.fi/foundation/visual-assets/icons/list
    #
    # Some extra icons have been added to the original Decidim icons set on top
    # of the open-ionic icons, such as component and participatory space icons.
    # Those icons should not visible anywhere in the participant-facing UI.
    #
    # Note that not all icons have a corresponding equivalent in which case the
    # replacement is marked as `nil` and the original icon will be used in the
    # final SVG.
    #
    # To get the list of Decidim icons, you can use the following (bash) command:
    # grep -oPm1 '(?<=<symbol id=")[^"]+' $(bundle show decidim-core)/app/packs/images/decidim/icons.svg
    icons_mapping = {
      "account-login": "signin",
      "account-logout": "signout",
      "action-redo": "arrow-redo",
      "action-undo": "arrow-undo",
      actions: "check-circle",
      "align-center": nil,
      "align-left": nil,
      "align-right": nil,
      aperture: nil,
      "arrow-bottom": "arrow-down",
      "arrow-circle-bottom": "arrow-down",
      "arrow-circle-left": "arrow-left",
      "arrow-circle-right": "arrow-right",
      "arrow-circle-top": "arrow-up",
      "arrow-left": "arrow-left",
      "arrow-right": "arrow-right",
      "arrow-thick-bottom": "arrow-down",
      "arrow-thick-left": "arrow-left",
      "arrow-thick-right": "arrow-right",
      "arrow-thick-top": "arrow-up",
      "arrow-top": "arrow-up",
      "arrow-thin-right": "arrow-right",
      "arrow-thin-up": "arrow-up",
      "arrow-thin-left": "arrow-left",
      "arrow-thin-down": "arrow-down",
      "audio-spectrum": "graph-columns",
      audio: "volume-high",
      badge: "ticket",
      ban: "cross-circle",
      "bar-chart": "graph-columns",
      basket: "trash",
      "battery-empty": nil,
      "battery-full": nil,
      beaker: nil,
      bell: "bell",
      bluetooth: nil,
      bold: "text-bold",
      bolt: nil,
      book: nil,
      bookmark: nil,
      box: "layers",
      briefcase: "occupation",
      "british-pound": nil,
      browser: "display",
      brush: "pen",
      bug: nil,
      bullhorn: "volume-low",
      calculator: nil,
      calendar: "calendar",
      "camera-slr": "camera",
      "caret-bottom": "angle-down",
      "caret-left": "angle-left",
      "caret-right": "angle-right",
      "caret-top": "angle-up",
      cart: "shopping-cart",
      chat: "speechbubble",
      check: "check",
      "chevron-bottom": "angle-down",
      "chevron-left": "angle-left",
      "chevron-right": "angle-right",
      "chevron-top": "angle-up",
      "circle-check": "check-circle-fill",
      "circle-check-old": "check-circle",
      "circle-x": "cross-circle",
      clipboard: "copy",
      clock: "clock",
      "cloud-download": "download-cloud",
      "cloud-upload": "upload-cloud",
      cloud: "download-cloud",
      cloudy: nil,
      code: nil,
      cog: "cogwheel",
      "collapse-down": "angle-down",
      "collapse-left": "angle-left",
      "collapse-right": "angle-right",
      "collapse-up": "angle-up",
      command: "display",
      "comment-square": "speechbubble",
      compass: "locate",
      contrast: nil,
      copywriting: "document",
      "credit-card": nil,
      crop: nil,
      dashboard: "sliders",
      "data-transfer-download": "download",
      "data-transfer-upload": "upload",
      debates: nil,
      delete: "trash",
      dial: "sliders",
      document: "document",
      dollar: nil,
      "double-quote-sans-left": nil,
      "double-quote-sans-right": nil,
      "double-quote-serif-left": nil,
      "double-quote-serif-right": nil,
      droplet: nil,
      eject: "arrow-up",
      elevator: "sort",
      ellipses: "menu-dots",
      "envelope-closed": "envelope",
      "envelope-open": "envelope",
      euro: "glyph-euro",
      excerpt: "document",
      "expand-down": "angle-down",
      "expand-left": "angle-left",
      "expand-right": "angle-right",
      "expand-up": "angle-up",
      # Hel.fi uses arrow-top-right as the external link indicator but this is
      # not according to the HSD documentation.
      "external-link": "link-external",
      eye: "eye",
      eyedropper: "vaccine",
      facebook: "facebook",
      file: "document",
      fire: nil,
      flag: nil,
      flash: nil,
      folder: "layers",
      fork: "sitemap",
      "fullscreen-enter": "sort",
      "fullscreen-exit": "collapse",
      github: nil,
      globe: "globe",
      google: "google",
      graph: "graph-columns",
      "grid-four-up": nil,
      "grid-three-up": nil,
      "grid-two-up": nil,
      "hard-drive": "save-diskette",
      header: nil,
      headphones: "headphones",
      heart: "heart-fill",
      home: "home",
      image: "photo",
      inbox: "speechbubble-text",
      infinity: nil,
      info: "info-circle",
      instagram: "instagram",
      italic: "text-italic",
      "justify-center": nil,
      "justify-left": nil,
      "justify-right": nil,
      key: "key",
      laptop: "display",
      layers: "layers",
      lightbulb: "lightbulb",
      "link-broken": "link",
      "link-intact": "link",
      "list-rich": "menu-hamburger",
      list: "menu-hamburger",
      location: "location",
      "lock-locked": "lock",
      "lock-unlocked": "lock-open",
      "loop-circular": "refresh",
      "loop-square": "refresh",
      loop: "refresh",
      "magnifying-glass": "search",
      "map-marker": "location",
      map: "map",
      "media-pause": "playback-pause",
      "media-play": "playback-play",
      "media-record": "playback-record",
      "media-skip-backward": "playback-rewind",
      "media-skip-forward": "playback-fastforward",
      "media-step-backward": "playback-previous",
      "media-step-forward": "playback-next",
      "media-stop": "playback-stop",
      "medical-cross": nil,
      meetings: nil,
      menu: "menu-hamburger",
      microphone: "microphone",
      minus: "minus",
      monitor: "display",
      moon: nil,
      move: "drag",
      "musical-note": nil,
      paperclip: "paperclip",
      pencil: "pen",
      people: "group",
      person: "user",
      phone: "phone",
      "pie-chart": nil,
      pin: "location",
      "play-circle": "playback-play",
      plus: "plus",
      "power-standby": nil,
      print: "printer",
      process: nil,
      project: "scroll-content",
      pulse: nil,
      "puzzle-piece": nil,
      "question-mark": "question-circle",
      rain: nil,
      random: "refresh",
      reload: "refresh",
      "resize-both": "drag",
      "resize-height": "drag",
      "resize-width": "drag",
      "rss-alt": "rss",
      rss: "rss",
      script: nil,
      "share-boxed": "share",
      share: "share",
      shield: "shield",
      signal: "graph-columns",
      signpost: nil,
      "sort-ascending": "sort-ascending",
      "sort-descending": "sort-descending",
      spreadsheet: "document",
      star: "star-fill",
      sun: nil,
      tablet: nil,
      tag: nil,
      tags: nil,
      target: "locate",
      task: "check-circle",
      terminal: nil,
      text: "text-tool",
      "thumb-down": "thumbs-down",
      "thumb-up": "thumbs-up",
      timer: "clock",
      transfer: nil,
      trash: "trash",
      twitter: "twitter",
      underline: nil,
      "verified-badge": nil,
      "vertical-align-bottom": nil,
      "vertical-align-center": nil,
      "vertical-align-top": nil,
      video: "videocamera",
      "volume-high": "volume-high",
      "volume-low": "volume-low",
      "volume-off": "volume-mute",
      warning: "error-fill",
      wifi: "wifi",
      wrench: "cogwheels",
      x: "cross",
      yen: nil,
      youtube: "youtube",
      "zoom-in": "zoom-in",
      "zoom-out": "zoom-out",
      "random-seed": "refresh",
      "euro-outline": "glyph-euro",
      datetime: "clock",
      members: "group",
      speakers: "group",
      profile: "user",
      # Decidim
      videos: "playback-next",
      consultation: "speechbubble", # space
      sortition: "refresh", # component
      assemblies: "group", # space
      initiatives: "lightbulb", # space
      proposals: "lightbulb", # component
      "proposals-old": nil, # component
      blog: "document", # component
      information: "info-circle-fill" # component
    }
    # These are icons not included in the HDS icons pack but were in the
    # OmaStadi design + needed for the area information pages.
    # rubocop:disable Layout/LineLength
    custom_icons = {
      "animal-lamb": %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m14.763 0.536a2.9871 2.9872 0 0 0-2.724 1.7615 3.0775 3.0775 0 0 0-1.5388-0.41084 3.1253 3.1254 0 0 0-2.8787 1.9878c-0.09114-0.0085-0.18292-0.01375-0.27588-0.01375-0.89445 0-1.709 0.40079-2.3636 1.0306-0.35255-0.11196-0.75637-0.11135-1.191-0.03374-0.54483 0.09729-1.1407 0.31954-1.7285 0.65896-0.71639 0.4136-1.2908 0.92442-1.6556 1.4521-0.36478 0.52766-0.55507 1.1297-0.26887 1.6392 0.28664 0.51029 0.90344 0.65252 1.5393 0.60212 0.52023-0.04124 1.1035-0.24023 1.6901-0.52504-0.01094 0.15935-0.04086 0.31716-0.04075 0.47702v5.19e-4c1.05e-4 1.4345 0.42716 2.7403 1.1406 3.7048 0.71357 0.96462 1.7347 1.5948 2.8782 1.5948 0.07253 0 0.14444-0.0025 0.21593-0.0075a3.132 3.132 0 0 0 2.2385 2.0768v6.9327h2.3654v-7.0601a2.9845 2.9845 0 0 0 5.1888 0.01298v7.0471h2.3641v-6.9205a3.14 3.14 0 0 0 2.4264-3.0734 3.1891 3.1891 0 0 0-0.13288-0.91434 3.7299 3.73 0 0 0 0-6.5963 3.1891 3.1891 0 0 0 0.13288-0.91408 3.1386 3.1387 0 0 0-3.1201-3.1588 3.0762 3.0762 0 0 0-1.5375 0.41084 2.9871 2.9872 0 0 0-2.724-1.7615zm-7.4174 4.078c0.7451 0 1.4363 0.34796 2.0041 0.9665l0.19854 0.21619 0.25823-0.13963c0.16704-0.0903 0.51886-0.13665 0.96001-0.05788 0.44114 0.07878 0.96492 0.26994 1.484 0.56968h2.6e-4c0.63238 0.3651 1.1317 0.82164 1.4129 1.2281s0.30861 0.70483 0.23176 0.84115c-0.07698 0.13653-0.33745 0.2607-0.82401 0.22268-0.48656-0.03802-1.1284-0.2406-1.7609-0.60575l-0.0013-7.79e-4 -0.0013-7.78e-4c-0.07229-0.04096-0.14259-0.08413-0.21567-0.13029l-0.71683-0.45263 0.1443 0.83544c0.06028 0.34866 0.0906 0.70169 0.09032 1.0555v2.59e-4c0 1.2841-0.38817 2.4401-0.99245 3.2574-0.60428 0.81729-1.4036 1.2894-2.2719 1.2894s-1.6681-0.47231-2.2727-1.2896c-0.6046-0.81731-0.99271-1.9731-0.99271-3.2571v-2.59e-4c-2.79e-4 -0.35384 0.02978-0.70686 0.09006-1.0555l0.14456-0.83544-0.71683 0.45263c-0.07308 0.04615-0.14427 0.08984-0.21671 0.13158-0.63332 0.36264-1.2764 0.56532-1.7635 0.60393-0.48733 0.03863-0.7466-0.08457-0.82272-0.22008-0.07656-0.1363-0.04925-0.43518 0.23176-0.84167 0.28101-0.40649 0.78029-0.86304 1.4126-1.2281 0.51908-0.29974 1.0429-0.4909 1.484-0.56968 0.44114-0.07877 0.79322-0.03243 0.96027 0.05788l0.25823 0.13963 0.19828-0.21619c0.56762-0.61835 1.2603-0.9665 2.0054-0.9665zm-1.4277 3.3994c-0.57226 0-1.0341 0.4806-1.0111 1.0524l0.3758-0.01505c-0.0146-0.36341 0.27164-0.66129 0.63533-0.66129 0.3637 0 0.64994 0.29789 0.63533 0.66129l0.3758 0.01505c0.02298-0.57181-0.43887-1.0524-1.0111-1.0524zm2.9864 0.03426c-0.55588 0-1.0106 0.45473-1.0106 1.0106h0.37606c0-0.35266 0.2819-0.63456 0.63455-0.63456s0.63456 0.2819 0.63456 0.63456h0.37606c0-0.55589-0.45473-1.0106-1.0106-1.0106z" fill="currentColor"/>
        </svg>
      ),
      bicycle: %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m13.467 4.534-0.53437 1.5984h1.7626c0.61937 0 1.17 0.39667 1.3664 0.98437l0.5625 1.6828h-8.8898l-1.3336 1.9992c-0.57883-0.26219-1.2131-0.39844-1.8679-0.39844-1.2109 0-2.3501 0.4703-3.2063 1.3266-0.85622 0.85622-1.3266 1.9954-1.3266 3.2063 0 1.2109 0.4703 2.3501 1.3266 3.2063 0.85622 0.85622 1.9954 1.3266 3.2063 1.3266 1.2109 0 2.3501-0.4703 3.2063-1.3266 0.66497-0.66497 1.0978-1.5014 1.2586-2.4071h2.1281l0.47578 1.4672h1.5984l-0.47813-1.4813 3.5602-5.3179h0.87422l0.17813 0.52969c-0.39011 0.20772-0.74938 0.47515-1.0711 0.79687-0.85622 0.85622-1.3289 1.9954-1.3289 3.2063s0.4727 2.3501 1.3289 3.2063c0.85622 0.85622 1.9931 1.3266 3.2039 1.3266 1.2108 0 2.3501-0.4703 3.2063-1.3266 0.85622-0.85622 1.3266-1.9954 1.3266-3.2063 0-1.2109-0.4703-2.3501-1.3266-3.2063-0.85622-0.85622-1.9954-1.3266-3.2063-1.3266-0.23432 0-0.46577 0.01845-0.69374 0.05392l-1.3031-3.9141c-0.39898-1.1982-1.5216-2.0063-2.7844-2.0063h-1.2187zm-7.4602 1.5984-0.0047 1.6008h4.1321l-0.53437-1.6008h-3.5929zm2.5852 4.2679h5.7632l-2.2571 3.3868-0.36328-1.1203h-1.6008l0.47578 1.4672h-1.6126c-0.16086-0.90689-0.59125-1.7434-1.2563-2.4071-0.00761-0.0076-0.015838-0.0135-0.023438-0.02109l0.87422-1.3055zm10.875 1.5984c1.6175 0 2.9321 1.3169 2.9321 2.9344s-1.3146 2.9321-2.9321 2.9321v0.0023c-1.6175 0-2.9321-1.3169-2.9321-2.9344 0-1.0209 0.52423-1.9212 1.3172-2.4469l1.0805 3.2461h1.6008l-1.2422-3.7266c0.05827-0.0039 0.11626-7e-3 0.17578-7e-3zm-14.932 0.0023c0.33565 0 0.6584 0.05659 0.9586 0.16172l-1.514 2.2687 0.42187 1.3031h2.9531c-0.34937 1.2292-1.4806 2.1317-2.8195 2.1328h-0.00234c-1.6164-0.0014-2.9321-1.3177-2.9321-2.9344 0-1.6175 1.3169-2.9321 2.9344-2.9321zm2.2664 1.0758c0.2514 0.30743 0.4442 0.66506 0.55547 1.057h-1.2632l0.70781-1.057z" fill="currentColor"/>
        </svg>
      ),
      boat: %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m9.0701 7.3545-1.6827 2.1728-4.5291 0.03018c0.2535 2.3961 2.1994 3.5778 4.5267 3.5754l13.761-0.0097v-3.6949l-12.821 0.099019 1.6803-2.1728zm-5.0699 6.633c-1.2023 0-1.8503 0.40798-2.3718 0.73511-0.46353 0.29091-0.83053 0.52033-1.6284 0.52033v1.4002h0.16527c1.0973-0.03621 1.7094-0.42011 2.2068-0.73275 0.45871-0.28488 0.83029-0.52033 1.6282-0.52033 0.79791 0 1.1637 0.22942 1.6273 0.52033 0.52148 0.32713 1.1697 0.73511 2.372 0.73511 1.2023 0 1.8517-0.40798 2.3732-0.73511 0.46353-0.29091 0.82814-0.52033 1.6273-0.52033 0.79911 0 1.1649 0.22942 1.6284 0.52033 0.52148 0.32713 1.1707 0.73511 2.3718 0.73511 1.2011 0 1.8506-0.40798 2.372-0.73511 0.46353-0.29091 0.83053-0.52033 1.6284-0.52033 0.79791 0 1.1637 0.22942 1.6273 0.52033 0.52148 0.32713 1.171 0.73511 2.372 0.73511v-1.4026c-0.79791 0-1.1637-0.22942-1.6273-0.52033-0.52148-0.32713-1.1697-0.73511-2.372-0.73511-1.2023 0-1.8506 0.40798-2.372 0.73511-0.46353 0.29091-0.83053 0.52033-1.6284 0.52033-0.79791 0-1.1647-0.22942-1.627-0.52033-0.52268-0.32713-1.1721-0.73511-2.3732-0.73511-1.2011 0-1.8506 0.40798-2.372 0.73511-0.46353 0.29091-0.83053 0.52033-1.6284 0.52033-0.79791 0-1.1637-0.22942-1.6273-0.52033-0.52148-0.32713-1.1697-0.73511-2.372-0.73511z" fill="currentColor"/>
        </svg>
      ),
      book: %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m16.24 5.221c-0.07896 0-0.1538 0.0046-0.23044 0.0069v-5.2279h-3.4034c-2.5449 0-4.6153 2.0704-4.6153 4.6153v0.61288c-0.07716-0.0023-0.15226-0.0072-0.23173-0.0072h-7.2692v16.962h7.2692c1.9212 0 2.9289 0.61006 3.6863 1.2849l0.46757 0.46757 0.0108-0.01106 0.07587 0.07587c0.84667-0.84693 1.8173-1.8173 4.2403-1.8173h7.2692v-16.962zm-6.2883-0.60568c0-1.4637 1.1908-2.6545 2.6545-2.6545h1.4426v11.366h-1.4434c-0.98375 0-1.9004 0.31866-2.6537 0.85953zm0 13.337c0.0162-0.86313 0.43491-1.629 1.0676-2.1162v4.4324l-0.2914-0.29114c-0.447-0.447-0.75305-1.2196-0.7762-1.9462zm-7.501 2.27v-13.04h5.3084c0.07999 0 0.15534 0.0041 0.23147 0.0072l-1e-3 10.754c0 0.79806 0.20267 1.6098 0.55862 2.3098-0.25102-0.0198-0.51284-0.03112-0.78906-0.03112zm19.098 0h-5.3084c-1.3796 0-2.432 0.26182-3.2599 0.63578v-5.5695h3.0294v-8.0997c0.07587-0.0031 0.15071-0.0067 0.23044-0.0067h5.3084z" fill="currentColor"/>
        </svg>
      ),
      buoy: %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m22.377 19.665c-0.52176-0.32731-1.1716-0.73554-2.3733-0.73554a3.8323 3.8323 0 0 0-2.0532 0.53867c0.01087-0.14373 0.0157-0.28866 0.0157-0.4348a5.9689 5.9689 0 0 0-5.5353-5.9592v-6.6428a2.0339 2.0339 0 1 0-0.86115 0v6.6428a5.9689 5.9689 0 0 0-5.5377 5.9544c0 0.14614 0 0.29108 0.0157 0.4348a3.8323 3.8323 0 0 0-2.0532-0.53867c-1.2078 0-1.8515 0.40823-2.3733 0.73554-0.46138 0.29832-0.82734 0.52659-1.6209 0.52659v1.3998h0.16547c1.0979-0.03623 1.7102-0.42031 2.2078-0.73312 0.46379-0.29108 0.82975-0.52056 1.6281-0.52056s1.1655 0.22948 1.6293 0.52056a5.179 5.179 0 0 0 0.85632 0.46137 3.9495 3.9495 0 0 0 1.5158 0.27417c1.2078 0 1.8515-0.40823 2.3733-0.73554 0.46379-0.29108 0.82975-0.52056 1.6293-0.52056s1.1643 0.22948 1.6281 0.52056c0.52177 0.32731 1.1716 0.73554 2.3733 0.73554a3.9495 3.9495 0 0 0 1.5061-0.27658 5.2442 5.2442 0 0 0 0.85753-0.46137c0.46379-0.29108 0.82975-0.52055 1.6281-0.52055s1.1655 0.22948 1.6293 0.52055c0.52176 0.32731 1.1703 0.73554 2.3721 0.73554v-1.3998c-0.79352 0-1.1595-0.22827-1.6233-0.52176zm-11.549-15.212a1.1728 1.1728 0 1 1 1.1716 1.1716 1.1728 1.1728 0 0 1-1.1716-1.1716z" fill="currentColor"/>
        </svg>
      ),
      "circle-line": %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m12 1c-6.0633 0-11 4.9367-11 11 0 6.0633 4.9367 11 11 11 6.0633 0 11-4.9367 11-11 0-6.0633-4.9367-11-11-11zm0 2c4.9824 0 9 4.0176 9 9 0 4.9824-4.0176 9-9 9-4.9824 0-9-4.0176-9-9 0-4.9824 4.0176-9 9-9z" fill="currentColor"/>
        </svg>
      ),
      escalator: %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m7.8023 0.0032902a2.2929 2.2928 0 0 0-0.64994 0.05813 2.2929 2.2928 0 0 0-1.7049 2.7582 2.2929 2.2928 0 0 0 2.7583 1.7046 2.2929 2.2928 0 0 0 1.7049-2.758 2.2929 2.2928 0 0 0-2.1083-1.763zm11.592 0.44148a4.1502 4.1501 0 0 0-2.4669 1.1855l-7.0342 7.034v-1.1619a2.2144 2.2144 0 1 0-4.4273 0v5.5894l-4.2545 4.2541a4.1447 4.1447 0 0 0 0 5.856 4.1447 4.1447 0 0 0 5.86 0l15.717-15.712a4.1488 4.1487 0 0 0 0-5.8599 4.1502 4.1501 0 0 0-3.3945-1.1855zm0.29115 1.8193a2.2049 2.2049 0 0 1 1.725 3.8478l0.0069 0.0082-15.716 15.714a2.2022 2.2022 0 0 1-3.1113 0 2.2049 2.2049 0 0 1 0-3.1112l15.709-15.722a2.2049 2.2049 0 0 1 1.3863-0.73659z" fill="currentColor"/>
        </svg>
      ),
      field: %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m21.809 7.5173c-0.51231 0.0179-1.0411 0.14118-1.4993 0.36025-1.2928 0.61674-1.9307 2.3674-2.1069 3.2044 1.4767-1.946 4.8766-2.3983 4.8766-2.3983-2.8998 0.89829-4.5471 2.4097-5.0068 3.2467a0.33901 0.33901 0 0 1-0.6034 0c-0.45968-0.837-2.1067-2.3484-5.0046-3.2467 0 0 3.3996 0.4523 4.8744 2.3983-0.17046-0.837-0.80827-2.5877-2.1069-3.2044-1.2258-0.5746-2.9456-0.48094-3.5202 0.47098-0.48841 0.81976 0.16062 2.3598 1.4956 2.9478 1.8981 0.837 3.2563 0.19161 4.0607 1.0822a0.90404 0.90404 0 0 1 0.22221 0.61276v1.5783a4.5202 4.5202 0 0 0-4.0244 0.47883c-0.47309 0.29879-0.78711 0.49043-1.4881 0.49043s-1.0132-0.19547-1.4863-0.49043a4.5202 4.5202 0 0 0-5.0124 0c-0.47309 0.29879-0.78333 0.49043-1.4863 0.49043s-1.015-0.19547-1.4881-0.49043a4.1735 4.1735 0 0 0-2.5053-0.76613v0.9442c0.70101 0 1.0132 0.19542 1.4863 0.4923a4.5202 4.5202 0 0 0 5.0124 0c0.47309-0.30071 0.78711-0.4923 1.4881-0.4923 0.70101 0 1.0132 0.19542 1.4863 0.4923 0.54012 0.34476 0.79863 0.76613 2.0934 0.76613a5.8264 5.8264 0 0 0 2.919-0.76613c0.47309-0.30071 0.78524-0.4923 1.4863-0.4923s1.0135 0.19542 1.4866 0.4923a4.5202 4.5202 0 0 0 5.0124 0c0.47309-0.30071 0.78524-0.4923 1.4863-0.4923v-0.9442a4.1793 4.1793 0 0 0-2.5053 0.76613c-0.47309 0.29879-0.78524 0.49043-1.4863 0.49043-0.70101 0-1.0135-0.19547-1.4866-0.49043a4.5202 4.5202 0 0 0-0.41561-0.22183v-1.8237a0.91361 0.91361 0 0 1 0.22221-0.61276c0.80444-0.88488 2.1626-0.24524 4.0607-1.0822 1.3407-0.58801 1.9843-2.1282 1.4844-2.9594-0.35912-0.59854-1.1673-0.86106-2.0212-0.83122z" fill="currentColor"/>
        </svg>
      ),
      flag: %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m3.4102 2v20h2.2871v-10.896h14.838l-3.1113-4.6133 3.168-4.4902z" fill="currentColor"/>
        </svg>
      ),
      flower: %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m12 9.3637 0.6623 0.70846c0.45198 0.48341 1.1678 0.58999 1.7407 0.2592 0.57289-0.33078 0.83855-1.0041 0.646-1.6373l-0.28219-0.92769 0.94445-0.21938c0.64469-0.1498 1.0949-0.71644 1.0949-1.3781 0-0.66145-0.45022-1.2281-1.0949-1.3778l-0.94445-0.21939 0.28219-0.92763c0.19256-0.63326-0.073098-1.3065-0.6461-1.6375-0.57295-0.33061-1.2887-0.22408-1.7406 0.25937l-0.66236 0.70852-0.66236-0.70852c-0.45192-0.48352-1.1678-0.58999-1.7407-0.25925-0.57294 0.33078-0.83854 1.0041-0.64599 1.6374l0.28219 0.92769-0.9445 0.21938c-0.64469 0.14974-1.0949 0.71633-1.0949 1.3778 0 0.66163 0.45016 1.2283 1.0949 1.378l0.9445 0.21939-0.28219 0.92774c-0.19255 0.63326 0.073098 1.3065 0.64599 1.6373 0.57295 0.33072 1.2888 0.22414 1.7408-0.25926zm-6.7773 5.6947c0.13037 0.76391 0.64044 1.4169 1.3731 1.7226 0.7327 0.30587 1.5556 0.20942 2.1903-0.23518-0.13025-0.76385-0.64032-1.4168-1.3731-1.7228-0.73264-0.30575-1.5556-0.2092-2.1903 0.23535m9.991 1.4874c0.63472 0.44462 1.4576 0.54117 2.1902 0.2353 0.73275-0.30581 1.2428-0.95877 1.3732-1.7227-0.63472-0.4445-1.4576-0.54111-2.1904-0.23529-0.7327 0.30592-1.2428 0.95883-1.373 1.7227m-2.307 7.4537h-1.8136v-4.7018c0-1.0416-0.62488-1.341-1.057-1.4233-1.1624 0.93085-2.7418 1.1634-4.1389 0.58025-1.5332-0.63988-2.5228-2.1274-2.5209-3.7894l3.8e-4 -0.37723 0.26792-0.26559c1.1802-1.1702 2.9336-1.5127 4.4669-0.87275 1.2793 0.53415 2.18 1.658 2.4422 2.9807 0.18678 0.046 0.3672 0.10777 0.53936 0.18451v-4.0746c-0.79108 0.20014-1.6508 0.095998-2.4029-0.3382-1.0536-0.60823-1.6518-1.7237-1.6146-2.8899-1.0286-0.55074-1.6956-1.6266-1.6956-2.8431 0-1.2164 0.66695-2.2922 1.6956-2.8429-0.037199-1.1662 0.56099-2.2816 1.6145-2.8899 1.0535-0.60817 2.3187-0.56853 3.3098 0.046799 0.99111-0.6153 2.2561-0.65511 3.3097-0.046899 1.0536 0.6084 1.6518 1.7239 1.6146 2.89 1.0285 0.5508 1.6956 1.6265 1.6956 2.8429 0 1.2165-0.66701 2.2923-1.6956 2.8431 0.0372 1.1661-0.561 2.2816-1.6145 2.8899-0.75201 0.4342-1.6121 0.53817-2.403 0.33837v4.0745c0.17217-0.0767 0.35253-0.13841 0.53937-0.18445 0.26214-1.3229 1.1628-2.4466 2.4421-2.9807 1.5335-0.63999 3.2867-0.29732 4.467 0.87275l0.26792 0.26559 3.8e-4 0.37723c2e-3 1.6621-0.98766 3.1496-2.521 3.7895-1.397 0.58308-2.9765 0.35066-4.1388-0.58031-0.4321 0.0823-1.057 0.38169-1.057 1.4233z" fill="currentColor"/>
        </svg>
      ),
      hiker: %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m13.359 3.6644e-4a2.2154 2.2154 0 0 0-0.31472 0.02819 2.2154 2.2154 0 0 0-1.8319 2.542 2.2154 2.2154 0 0 0 2.542 1.8316 2.2154 2.2154 0 0 0 1.8316-2.5417 2.2154 2.2154 0 0 0-2.2269-1.8601zm5.3576 4.514-0.18203 3.5241h0.48633v0.0015c0.02981-0.0016 0.0612-0.0031 0.09101-0.0031 0.11454 0 0.22611 0.01416 0.3328 0.03769l0.1805-3.5116zm-7.4234 0.05608c-0.89349-0.05277-1.5618 0.75396-1.6894 1.634l-0.85345 5.8868c-0.16475 1.1328 0.2446 2.272 1.0919 3.0424l3.237 2.9419 1.1391 5.4238 2.1353-0.06098-1.2865-6.6652c-0.04864-0.33577-0.196-0.6496-0.42351-0.90064l-2.1794-2.4038 0.57122-3.9427 1.0526 0.83936c0.27301 0.21809 0.61971 0.32484 0.9696 0.29817l4.2694-0.33433-0.28254-1.561-2.8837-0.0095c-0.44717 0-0.86608-0.21973-1.125-0.58531 0 0-2.1935-3.1441-3.3467-3.5254-0.13592-0.04491-0.26829-0.06999-0.39593-0.07753zm-3.0121 0.60922c-2.2939 0-3.8143 5.2249-3.8143 5.2249-0.35773 1.0936 0.35609 2.2451 1.4936 2.4114l1.0217 0.14924v0.0015c0.45501 0.0659 0.87853-0.24951 0.946-0.70452 0 0 0.69984-4.7338 0.92577-6.3122 0.08629-0.59936-0.16951-0.77041-0.57275-0.77041zm11.004 5.8838-0.91658 0.07079-0.74681 12.866h1.0404zm-10.894 3.3154-0.78297 3.7797-2.8208 5.8415 1.9079-0.04413 2.3707-4.1563 1.649-2.8883-1.3634-1.2396v0.0015c-0.40794-0.37028-0.72976-0.81118-0.9604-1.2944z" fill="currentColor"/>
        </svg>
      ),
      leaf: %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m19.612 7.2426c0-2.1553-1.7147-3.0724-2.6356-3.5651-0.19865-0.10624-0.40378-0.21593-0.49424-0.28675-0.21679-0.16972-0.45192-0.52642-0.70088-0.90428-0.69159-1.0494-1.6385-2.4865-3.7817-2.4865-2.1754 0-3.1244 1.5076-3.7523 2.5051-0.23514 0.37355-0.4571 0.72614-0.66353 0.89111-0.08874 0.07104-0.30553 0.18526-0.5152 0.2956-0.93689 0.4936-2.6812 1.4122-2.6812 3.5508 0 1.229 0.63352 2.0573 1.1427 2.7228 0.41933 0.54823 0.67649 0.90558 0.67649 1.3234 0 0.29948-0.11724 0.47309-0.3824 0.83713-0.3485 0.4787-0.8259 1.1342-0.8259 2.289 0 1.9517 1.6358 3.117 3.2179 4.2438 1.52 1.0826 2.956 2.1055 2.956 3.699v1.6423h1.655v-1.6423c0-1.5935 1.4359-2.6164 2.9562-3.699 1.5818-1.1267 3.2177-2.292 3.2177-4.2438 0-1.1547-0.47741-1.8103-0.8259-2.289-0.26515-0.36404-0.38219-0.53765-0.38219-0.83713 0-0.41782 0.25694-0.77516 0.67627-1.3234 0.50915-0.66547 1.1427-1.4938 1.1427-2.7228m-1.6553 0c0 0.6685-0.3716 1.1545-0.80194 1.7172-0.47676 0.62315-1.017 1.3295-1.017 2.329 0 0.85094 0.38779 1.3834 0.69937 1.8114 0.29538 0.40572 0.50872 0.69872 0.50872 1.3147 0 1.0986-1.169 1.9312-2.5229 2.8955-0.67476 0.48086-1.3828 0.9887-1.9957 1.5754v-2.2518l2.5211-2.5211-1.1705-1.1705-1.3506 1.3508v-3.1764l3.1786-3.1783-1.1705-1.1705-2.0081 2.0081v-4.1815h-1.655v4.1813l-2.0081-2.0078-1.1703 1.1705 3.1783 3.1782v3.1766l-1.3506-1.3508-1.1705 1.1705 2.5211 2.5211v2.2517c-0.61301-0.58644-1.3208-1.0943-1.9957-1.5751-1.3538-0.96409-2.5229-1.7969-2.5229-2.8955 0-0.61603 0.21334-0.90904 0.50872-1.3147 0.31158-0.42796 0.69937-0.96042 0.69937-1.8114 0-0.9995-0.54024-1.7058-1.0168-2.329-0.43055-0.56269-0.80215-1.0487-0.80215-1.7172 0-1.0556 0.77883-1.5499 1.7974-2.0862 0.30359-0.16 0.56593-0.29797 0.77775-0.46747 0.42428-0.33943 0.71858-0.80712 1.0302-1.302 0.67821-1.0775 1.1751-1.7317 2.3516-1.7317 1.1675 0 1.6853 0.65813 2.3995 1.742 0.32561 0.49403 0.63308 0.96063 1.0632 1.2971 0.2034 0.15935 0.4489 0.29063 0.73327 0.44264 0.99777 0.53376 1.7611 1.0278 1.7611 2.1056" fill="currentColor"/>
        </svg>
      ),
      sea: %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m20.302 9.272h-6e-3c-1.1762-1e-3 -2.2483-0.35976-3.0018-0.97392-0.75548 0.61528-1.8276 0.97386-3.0017 0.97392h-6e-3c-1.1763-1e-3 -2.2483-0.35976-3.0018-0.97397-0.75554 0.61533-1.8277 0.97391-3.0018 0.97397h-6e-3c-1.6138-2e-3 -3.0312-0.6759-3.6992-1.7599l1.3969-0.86084c0.30006 0.48694 1.1288 0.97879 2.3039 0.97992h4e-3c1.1711 0 2.0018-0.49319 2.3059-0.98253l0.69968-1.126 0.69554 1.1286c0.30011 0.48689 1.1289 0.97879 2.304 0.97992h4e-3c1.1712 0 2.0017-0.49314 2.3057-0.98248l0.69974-1.1262 0.69558 1.1288c0.30006 0.48694 1.1288 0.97879 2.304 0.97992h4e-3c1.1712 0 2.0018-0.49314 2.3059-0.98248l1.3937 0.86596c-0.67366 1.0842-2.0909 1.7574-3.6996 1.7574m-4.578 4.6028h-5e-3c-1.1763-1e-3 -2.2484-0.35986-3.0019-0.97397-0.75559 0.61534-1.8279 0.97392-3.0023 0.97397h-5e-3c-1.1764-1e-3 -2.2484-0.35981-3.0019-0.97397-0.75558 0.61534-1.828 0.97392-3.0024 0.97397h-5e-3c-1.6138-2e-3 -3.0313-0.67601-3.6992-1.76l1.3969-0.86078c0.30006 0.48693 1.1288 0.97874 2.3038 0.97992h4e-3c1.1714 0 2.0022-0.49319 2.3063-0.98254l0.69974-1.1263 0.69558 1.1289c0.30006 0.48693 1.1288 0.97874 2.3039 0.97992h4e-3c1.1714 0 2.0022-0.49319 2.3062-0.98249l0.69969-1.1263 0.69564 1.1288c0.30006 0.48693 1.1289 0.97879 2.304 0.97997h4e-3c1.1714 0 2.0022-0.49324 2.3063-0.98259l1.3937 0.86606c-0.6738 1.0842-2.0913 1.7574-3.7002 1.7574m2.114 4.6027h-5e-3c-1.1764-1e-3 -2.2483-0.35971-3.0019-0.97393-0.75553 0.6153-1.8278 0.97387-3.0021 0.97393h-5e-3c-1.6139-2e-3 -3.0313-0.67591-3.6993-1.7599l1.3969-0.86089c0.30012 0.48699 1.1289 0.97879 2.304 0.97992h4e-3c1.1714 0 2.0021-0.49319 2.306-0.98248l0.69974-1.1261 0.69563 1.1287c0.30007 0.48694 1.1289 0.97879 2.304 0.97992h4e-3c1.1715 0 2.0023-0.49319 2.3063-0.98248l1.3937 0.86596c-0.67365 1.0842-2.0912 1.7574-3.7002 1.7574" fill="currentColor"/>
        </svg>
      ),
      sledding: %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m10.69 1.8386a1.4893 1.4893 0 0 0-1.4948 0.97589 1.4893 1.4893 0 0 0 0.88798 1.9092 1.4893 1.4893 0 1 0 0.60679-2.8851zm-1.5104 3.1306c-0.70288 0.0019-1.3516 0.39859-1.6032 1.0877l-1.4796 4.0468c-0.0042 0.01157-0.0067 0.02277-0.01063 0.03426l-4.8116-1.5404-0.4102 1.2824 17.726 5.6703a4.4678 4.4679 0 0 1-3.2424 0.20227l-14.881-4.757-0.41256 1.2883 15.085 4.8237a5.772 5.7721 0 0 0 1.3684 0.21408 5.847 5.8471 0 0 0 5.7612-4.0444l-1.28-0.42225a4.4364 4.4364 0 0 1-1.0283 1.7252l-8.139-2.6056c-0.17868-0.07882-0.34947-0.14491-0.47612-0.1914l-2.0749-0.76228 0.76227-2.6519 2.0942 2.4631 1.1602-0.9024-2.5576-3.7589s-0.23467-0.92311-1.0598-1.1385c-0.16378-0.04287-0.32881-0.06329-0.49101-0.06285zm-9.1801 8.9794c0.19599-0.17542 0 8.2159 0 8.2159h24v-0.70415z" fill="currentColor"/>
        </svg>
      ),
      "sport-football": %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m11.571 0.71461c-1.1316-0.01161-2.072 0.87136-2.142 2.0029-0.0723 1.1801 0.81906 2.1795 1.9992 2.2518 1.1801 0.07225 2.1796-0.83086 2.2518-1.9989 0.0723-1.1801-0.83086-2.1795-1.999-2.2518-0.0369-0.0023-0.0736-0.0036-0.11007-0.003999zm-0.74488 4.6884c-0.27697-0.01204-0.54209 0.03613-0.79497 0.12042-0.0361 0.01204-0.0843 0.03594-0.12043 0.04798l-1.3848 0.78274-1.5655 0.87916-0.33704 0.19263c-0.7707 0.43352-1.0838 1.0237-1.4571 1.7221l-1.6257 2.9863 1.7339 0.08444 1.6981-2.7095 1.3968-0.86717 0.12042-0.07221-0.0242 0.16864-0.5419 3.8775h0.0242v0.01223l-0.0242-0.01223-2.6131 4.0583-5.3106 0.25284 0.96338 1.7581 5.5394-0.0842c0.30105 0 0.44561-0.15655 0.5299-0.24084l2.9743-3.4562 2.6253 2.8661 0.99937 5.4552 2.0352 0.06021-0.84296-6.2017c-0.06021-0.2288-0.1566-0.45769-0.28906-0.63832l-2.3842-3.2996-0.0242 0.01199v-0.02399h0.0242l0.036-0.30105 0.0482-0.30105 0.32504-2.1194 0.0964-0.65032 0.73453 0.79473c0.5419 0.57802 1.3609 0.80691 2.1316 0.57811l3.5402-0.81895-0.96338-1.3606-3.2272 0.57788-2.0232-3.0587c-0.0361-0.06021-0.0842-0.12042-0.13241-0.18063-0.44557-0.56598-1.1439-0.90297-1.8905-0.89092zm10.248 9.8143a2.9263 2.9262 0 0 0-2.9264 2.9261 2.9263 2.9262 0 0 0 2.9264 2.9263 2.9263 2.9262 0 0 0 2.9261-2.9263 2.9263 2.9262 0 0 0-2.9261-2.9261z" fill="currentColor"/>
        </svg>
      ),
      "sport-hockey": %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m13.291 0.393a2.118 2.1179 0 0 0-2.1178 2.1178 2.118 2.1179 0 0 0 2.1178 2.118 2.118 2.1179 0 0 0 2.1181-2.118 2.118 2.1179 0 0 0-2.1181-2.1178zm-2.927 3.4387c-0.67822 0-1.3445 0.23797-1.8561 0.65442l-2.1181 1.9393c-0.59493 0.48784-0.69003 1.3683-0.20218 1.9633l1.63 2.0346-1.6895 4.5096-4.5454 2.9509c-0.28556 0.23797-0.32117 0.66632-0.0832 0.95188l2.832 3.3671c0.0952 0.10709 0.24987 0.11908 0.35696 0.03579 0.28557-0.23797 0.40456-0.63072 0.29747-0.98767l-0.48803-1.6419c-0.0714-0.23797 0.012-0.49969 0.20242-0.66627l3.5457-2.3202c0.20228-0.15468 0.36886-0.35696 0.47595-0.59493l1.3446-2.8677 1.7253 2.7011-0.51174 5.6279c0 0.36886 0.3095 0.67836 0.67836 0.67836l4.4025-0.01185c0.14278 0 0.24983-0.11917 0.24983-0.25006 0-0.36885-0.22598-0.71382-0.55914-0.8566l-1.5708-0.67812c-0.22608-0.09519-0.42831-0.32135-0.42831-0.57122l0.39275-3.8907 5.4139 7.032c0.20228 0.34506 0.64244 0.66627 1.0351 0.66627h2.6296c0.26177 0 0.47595-0.21417 0.47595-0.47594v-0.47594c0.0119-0.26177-0.20232-0.47594-0.46409-0.47594h-3.0816c-0.22607 0-0.42854-0.11894-0.54752-0.30932l-5.3663-6.8417v-0.09528h1.0948v-7.3771c0-1.1185-0.63068-2.1179-1.5945-2.6177-0.23797 0.07139-0.48794 0.10713-0.74971 0.10713-0.8567 0-1.6182-0.4283-2.0823-1.0827-0.27367-0.08329-0.55919-0.13084-0.84476-0.13084zm-1.0827 2.7367-0.61887 1.6419-0.4878-0.61863zm4.3312 1.7371v4.795l-1.2733-2.0346zm-13.243 10.613-0.36881 0.29746 3.2482 3.9028c0.39265 0.47594 1.1067 0.53534 1.5826 0.14269l-0.29746-0.36881c-0.28557 0.23797-0.69003 0.20232-0.91611-0.07135l-0.54752-0.65442 0.49988-0.41645-0.29747-0.36881-0.49988 0.41645-1.6063-1.9277 0.49988-0.41645-0.29746-0.36881-0.51174 0.4283zm11.673 3.534v0.65442h-0.77341v0.47594l5.0809 0.01185c0.61873 0 1.1183-0.49978 1.1183-1.1185h-0.47595c0.0238 0.35696-0.27353 0.64257-0.63049 0.64257h-0.85684v-0.65442h-0.47595v0.65442l-2.5106-0.01185v-0.65442z" fill="currentColor"/>
        </svg>
      ),
      stairs: %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path class="cls-2" d="m9.6633 9.6633h7.7099v-7.7099h6.6268v-1.9534h-8.5802v7.7087h-7.7099v7.7099h-7.7099v8.5815h1.9534v-6.628h7.7099z" fill="currentColor"/>
        </svg>
      ),
      "transit-metro": %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m2.88 0c-1.5905 0-2.88 1.2895-2.88 2.88v18.24c0 1.5905 1.2895 2.88 2.88 2.88h18.24c1.5905 0 2.88-1.2895 2.88-2.88v-18.24c0-1.5905-1.2895-2.88-2.88-2.88zm1.32 3.9244h4.8811l2.9292 11.017 2.8983-11.017h4.8914v16.15h-3.0295v-12.713l-3.2053 12.713h-3.1406l-3.1945-12.713v12.713l-3.03-4.69e-4z" fill="currentColor"/>
        </svg>
      ),
      "transit-train": %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m6.1465-3.1095e-8c-1.6053 0.0030239-2.9028 1.2468-2.9004 2.7793v12.937c-0.00232 1.5073 1.2536 2.7325 2.8223 2.7754l-2.2031 5.5081h2.1953l0.67188-1.7674h10.555l0.62695 1.7674h2.1953l-2.1895-5.5081c1.5732-0.03714 2.8363-1.2639 2.834-2.7754v-12.937c0.002384-1.5368-1.3023-2.7824-2.9121-2.7793zm2.6309 1.1828h6.4336v1.5577h-6.4336zm-2.1543 2.8201h10.742c0.77495-4e-7 1.4031 0.60031 1.4023 1.3401v4.3467c7.96e-4 0.7396-0.62762 1.3389-1.4023 1.3382h-10.742c-0.77472 7.58e-4 -1.4031-0.59859-1.4023-1.3382v-4.3467c-7.929e-4 -0.73982 0.6274-1.3401 1.4023-1.3401zm0.083984 9.6412c0.80297-0.01922 1.584 0.57032 1.584 1.4683 1e-7 0.80966-0.68705 1.4664-1.5352 1.4664-1.3682 0-2.0533-1.58-1.0859-2.5035 0.30229-0.28859 0.67212-0.42243 1.0371-0.43117zm10.477 0c0.80297-0.01922 1.584 0.57032 1.584 1.4683 0 0.80966-0.68705 1.4664-1.5352 1.4664-1.3682 1e-6 -2.0533-1.58-1.0859-2.5035 0.30229-0.28859 0.67212-0.42243 1.0371-0.43117zm-9.0508 4.9041 0.089844 2e-3h7.6719l0.08594-2e-3 0.67383 1.8995h-9.2441z" fill="currentColor"/>
        </svg>
      ),
      "transit-tram": %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m9.857 0v1.0394h1.6026v1.9071h-4.3886a2.4487 2.4487 0 0 0-2.4437 2.4525v11.412a2.4487 2.4487 0 0 0 2.4437 2.4522h0.046032l-1.8854 4.7368h1.813l1.7742-4.6896h6.4615l1.6534 4.6896h1.813l-1.8734-4.7368h0.0458a2.4487 2.4487 0 0 0 2.4536-2.4522v-11.412a2.4487 2.4487 0 0 0-2.4536-2.4525h-4.3884v-1.9071h1.6026v-1.0394zm-0.57174 3.9897h5.4195v1.3741h-5.4195zm-1.8141 2.4886h9.048a1.1808 1.1808 0 0 1 1.1808 1.182v3.8339a1.1796 1.1796 0 0 1-1.1808 1.1808h-9.048a1.1796 1.1796 0 0 1-1.1808-1.1808v-3.8339a1.1808 1.1808 0 0 1 1.1808-1.182zm0.60739 8.6049a1.2932 1.2932 0 0 1 0.79836 1.1947 1.2932 1.2932 0 0 1-1.2934 1.2932 1.2932 1.2932 0 1 1 0.49502-2.4879zm8.8231 0a1.2932 1.2932 0 0 1 0.79836 1.1947 1.2932 1.2932 0 0 1-1.2934 1.2932 1.2932 1.2932 0 1 1 0.49502-2.4879z" fill="currentColor"/>
        </svg>
      ),
      "tree-leaf": %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m12.843 13.37v1.9259c0.41422-0.19773 0.88071-0.30232 1.3699-0.30232h2.5648c0.95014 0 1.7536-0.45995 2.1491-1.2303 0.36526-0.71127 0.29076-1.544-0.19928-2.2275l-0.13679-0.19085c-0.67051-0.93497-0.67051-2.1916 1.2e-4 -3.1267l0.13663-0.19061c0.5962-0.83161 0.44516-1.7486 0.10502-2.3295-0.41962-0.71672-1.1531-1.0909-1.9618-1.0011l-0.23025 0.0255c-1.1442 0.12688-2.2237-0.5062-2.6856-1.5759l-0.0933-0.21593c-0.33682-0.77999-1.0325-1.2454-1.8611-1.2454-0.82858 0-1.5243 0.46545-1.8609 1.2452l-0.0936 0.21654c-0.46175 1.0693-1.5413 1.7025-2.6857 1.5755l-0.22985-0.0255c-0.8091-0.0898-1.5424 0.28441-1.962 1.0011-0.3401 0.5809-0.49113 1.4979 0.10497 2.3294l0.13683 0.19085c0.67047 0.93497 0.67047 2.1916-1.4e-4 3.1267l-0.13663 0.19062c-0.4901 0.6836-0.56455 1.5163-0.19935 2.2276 0.3956 0.77038 1.199 1.2303 2.1491 1.2303h2.5649c0.48915 0 0.95559 0.10459 1.3698 0.30232v-1.9259l-3.6505-3.7272 1.2039-1.1791 2.4465 2.498v-4.557h1.6852v4.557l2.4466-2.498 1.2039 1.1791zm0 10.63h-1.6852v-5.8203c0-0.72568-0.35986-1.5011-1.3698-1.5011h-2.5649c-1.5706 0-2.9686-0.82218-3.6482-2.1457-0.65956-1.2845-0.53668-2.772 0.32882-3.9792l0.13668-0.19066c0.24559-0.34246 0.24559-0.82056 1.4e-4 -1.1628l-0.13687-0.19095c-0.89189-1.244-0.96459-2.8391-0.18962-4.1627 0.75441-1.2883 2.1349-1.9874 3.6021-1.8245l0.22985 0.0255c0.40398 0.045 0.78658-0.18379 0.95284-0.56895l0.0937-0.21659c0.60241-1.3951 1.9083-2.2619 3.4079-2.2619 1.4996 0 2.8055 0.86687 3.408 2.2623l0.0934 0.21593c0.16645 0.38544 0.54906 0.6143 0.9528 0.56928l0.23023-0.0255c1.4672-0.16285 2.8476 0.53611 3.6019 1.8245 0.77503 1.3236 0.70232 2.9187-0.18966 4.1628l-0.13668 0.19067c-0.24555 0.34246-0.24555 0.82056-1.1e-4 1.1628l0.13683 0.19095c0.86544 1.2071 0.98833 2.6946 0.32876 3.9791-0.67962 1.3236-2.0776 2.1457-3.6482 2.1457h-2.5648c-1.01 0-1.3699 0.77544-1.3699 1.5011z" fill="currentColor"/>
        </svg>
      ),
      "tree-spurce": %(
        <svg version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path transform="matrix(.12683 0 0 .12683 -3.7131 -8.8816)" d="m93.13 189.87-22.15 50.49h44.81v18.9h16.21v-18.9h44.81l-22.15-50.49h12.35l-22.81-51.99h11.66l-31.96-67.85-31.97 67.85h11.66l-22.81 51.99z" fill="currentColor"/>
        </svg>
      )
    }
    # rubocop:enable Layout/LineLength
    # Extra icons not available in the original set
    extra_icons = {
      "animal-lamb": nil,
      bicycle: nil,
      binoculars: "binoculars",
      boat: nil,
      buoy: nil,
      "calendar-clock": "calendar-clock",
      "circle-line": nil,
      company: "company",
      escalator: nil,
      "face-smile": "face-smile",
      field: nil,
      flower: nil,
      "heart-line": "heart",
      hiker: nil,
      "home-smoke": "home-smoke",
      "info-line": "info-circle",
      leaf: nil,
      sea: nil,
      sledding: nil,
      "sport-football": nil,
      "sport-hockey": nil,
      stairs: nil,
      "star-line": "star",
      "transit-metro": nil,
      "transit-train": nil,
      "transit-tram": nil,
      traveler: "traveler",
      "tree-leaf": nil,
      "tree-spurce": nil
    }

    final_icons = original_icons.to_h do |key, icon|
      if custom_icons[key]
        replacement = Nokogiri::XML.parse(custom_icons[key], &:noblanks).css("svg").first
        icon = { content: hki_icon_content(replacement), attributes: { "viewBox" => replacement["viewBox"] } }
      elsif icons_mapping[key]
        replace_key = icons_mapping[key].to_sym
        replacement = hki_icon_svg(replace_key, icons_dir)
        icon = { content: hki_icon_content(replacement), attributes: { "viewBox" => replacement["viewBox"] } }
      end

      [key, icon]
    end
    extra_icons.each do |key, icon_key|
      icon_node =
        if custom_icons[key]
          Nokogiri::XML.parse(custom_icons[key], &:noblanks).css("svg").first
        else
          hki_icon_svg(icon_key, icons_dir)
        end
      final_icons[key] = { content: hki_icon_content(icon_node), attributes: { "viewBox" => icon_node["viewBox"] } }
    end

    # Generate the replacement SVG
    builder = Nokogiri::XML::Builder.new do |xml|
      xml.svg("xmlns" => "http://www.w3.org/2000/svg", "display" => "none", "viewBox" => "0 0 100 100") do
        final_icons.each do |key, icon|
          xml.symbol({ "id" => "icon-#{key}" }.merge(icon[:attributes])) do
            xml << icon[:content]
          end
        end
      end
    end
    # raise builder.doc.root.to_xml

    # Replace the target symbols file with the new one
    File.write(target_path, builder.to_xml(save_with: xmlopts))
    puts "Icons written to: #{target_path}"
  end

  def hki_icon_svg(icon, icons_dir)
    candidates = [
      "#{icons_dir}/ui/#{icon}.svg",
      "#{icons_dir}/some/#{icon}.svg"
    ]
    target_icon_path = candidates.find { |path| File.exist?(path) }
    raise "Unable to locate icon:\n  #{candidates.join("\n  ")}" unless target_icon_path

    icon_data = File.read(target_icon_path)
    Nokogiri::XML.parse(icon_data, &:noblanks).css("svg").first
  end

  def hki_icon_content(icon_node)
    icon_node.children.map { |node| node.to_xml(save_with: xmlopts) }.join
  end

  def xmlopts
    Nokogiri::XML::Node::SaveOptions::AS_XML | Nokogiri::XML::Node::SaveOptions::NO_DECLARATION
  end
end
